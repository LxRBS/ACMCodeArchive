{"scoring":null,"notes":"","legend":"Karen and her friends play in a music band in Karen's garage. She has complicated thoughts on which subsets of the band should be allowed to enter the garage. She designed a boolean formula $F$ in which each variable denotes the presence of a certain band member. She wants a group of people to be able to enter the garage if and only if $F$ is true.\r\n\r\nYou are asked to create a system of wires and locks that will fulfill the formula $F$. Each band member will receive a key that opens all the locks that are denoted by their letter.\r\n\r\nFor example, suppose that $F = a \\lor (b \\land c)$ and band members $a$ and $b$ are present. Then they should be able to enter the garage with their keys because $true \\lor (true \\land false) = true$.\r\n\r\nA band member doesn't have to use their key to open all the locks possible. For example, suppose that $F = a \\oplus b$. Then band member $a$ alone should be able to enter the garage because $true \\oplus false = true$. But if both $a$ and $b$ come to the garage, they can just disregard $b$'s key and open the garage using $a$'s one. However, $true \\oplus true = false$, so this formula $F$ is not fulfillable.\r\n\r\nThe system must be a rectangular grid of size at most $50 \\times 50$ containing horizontal wires `\\t{-}', vertical wires `\\t{|}', wire connections `\\t{+}', and locks. The upper leftmost and the upper rightmost cells of the grid must contain wire connections that will be attached to the doors of the garage. The garage doors stay closed as long as there is a path between these two connections via wires and locked locks.\r\n\r\nYou are to design such a system corresponding to the given formula $F$, or to state that there is no such system.\r\n","authorLogin":"dvorkin","language":"english","timeLimit":2000,"output":"If it is impossible to design the desired system, print one line ``\\t{IMPOSSIBLE}''.\r\n\r\nOtherwise, output a rectangular grid of characters --- the system corresponding to formula $F$. The system can only contain spaces, `\\t{-}', `\\t{|}', `\\t{+}', and letters corresponding to the band members that are mentioned in the input.\r\n\r\nThe upper leftmost and the upper rightmost cells should be wire connections.\r\nThe width of the grid should be between 2 and 50, inclusive, the height of the grid should be between 1 and 50, inclusive.\r\n\r\nCharacter `\\t{-}' must be used for a wire if and only if it connects something on the left and something on the right with empty cells below and above. Similarly, `\\t{|}' must be used for a wire if and only if it connects something below and something above with empty cells on the left and on the right.","inputFile":"stdin","outputFile":"stdout","input":"The input contains a non-empty boolean formula $F$.\r\n\r\nThe formula can contain letters \\t{a}, \\ldots, \\t{h} denoting the presence of band members, operators ``\\t{and}'', ``\\t{or}'', ``\\t{not}'', and parentheses. The length of the formula does not exceed 2020. The ``\\t{not}'' operator has the highest priority. The ``\\t{and}'' operator has higher priority than the ``\\t{or}'' operator. There are single spaces around each ``\\t{and}'', around each ``\\t{or}'', and after each ``\\t{not}''. There are no spaces other than those.","authorName":"Mikhail Dvorkin","sampleTests":[{"output":"+-+ +b-+\r\n| | |  |\r\n+-a-+-c+\r\n","input":"a or (b and c)\r\n","inputFile":"example.01","outputFile":"example.01.a"},{"output":"+a-f+\r\n|   |\r\n+g+h+\r\na | a\r\n+-+-+\r\n","input":"(a or f) and ((a and g) or (a and h))\r\n","inputFile":"example.02","outputFile":"example.02.a"},{"output":"IMPOSSIBLE\r\n","input":"a and not b or not a and b\r\n","inputFile":"example.03","outputFile":"example.03.a"},{"output":"+ +\r\n","input":"b or not b\r\n","inputFile":"example.04","outputFile":"example.04.a"},{"output":"+  +---+  +---+--+---+\r\n|  |      |   |  |    \r\n+--+      +---+  |    \r\n|  |      |      |    \r\n+  +------+      +---+\r\n","input":"d and not d\r\n","inputFile":"example.05","outputFile":"example.05.a"}],"name":"Keys and Locks Boolean Logic","interaction":null,"memoryLimit":536870912,"tutorial":""}