要形成若干个没有公共边的环，充要条件是每个点的度数都是偶数。将点的度数限制与格子的限制结合起来，将每条边是否存在作为变量，可以列出2nm个异或方程，使用高斯消元求解即可。若常数过大可以用bitset优化。
效率：O((nm)^3)